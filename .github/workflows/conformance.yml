name: Conformance Test

on:
  pull_request:
    branches: [main]
  push:
    branches: [main]
    tags: ['v*']

permissions:
  contents: read

jobs:
  conformance:
    uses: SamMorrowDrums/mcp-conformance-action/.github/workflows/conformance.yml@main
    with:
      install_command: "dotnet restore"
      build_command: "dotnet build -c Release"
      setup_dotnet: true
      dotnet_version: "8.0.x"
      configurations: |
        [
          {
            "name": "stdio",
            "transport": "stdio",
            "start_command": "dotnet run --no-build -c Release -- --stdio"
          },
          {
            "name": "http",
            "transport": "http",
            "start_command": "dotnet run --no-build -c Release -- --http --port 3000",
            "server_url": "http://localhost:3000/mcp",
            "health_endpoint": "/health"
          }
        ]
